name: Test Ubicloud Prod Runners

on:
  push:
    branches: [test-npm-ssl]
  # schedule:
  #   - cron: '0 * * * *'
  
jobs:
  test:
    strategy:
      fail-fast: false
      matrix:
        runs-on:
          - ubuntu-22.04
          - ubuntu-24.04
          - ubicloud-standard-2-ubuntu-2204
          - ubicloud-standard-2-ubuntu-2404
    runs-on: ${{ matrix.runs-on }}
    name: ${{ matrix.runs-on }}
    steps:
      - uses: actions/checkout@v4
      - run: openssl s_client -connect registry.npmjs.org:443
      - uses: actions/setup-node@v4
        with:
          node-version: 22.11
      - run: node -e 'fetch("https://google.com").then(console.log, console.error)'
      - run: node -e 'fetch("https://registry.npmjs.org/@actions/github").then(console.log, console.error)'
      - run: npm install @actions/github
      - run: node ssl-tester.js
    